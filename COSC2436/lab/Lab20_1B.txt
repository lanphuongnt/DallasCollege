package lab20;

import java.io.File;
import java.io.FileNotFoundException;

/**
 * Lab20_1B
 * @author Phuong Nguyen
 * This program will print the array of persons, calculate the average age and find the last person with the age larger than 30
 */

import java.util.ArrayList;
import java.util.ListIterator;
import java.util.Scanner;

public class Lab20_1B {

	public static void main(String[] args) throws FileNotFoundException {
		ArrayList<Person> persons = new ArrayList<>();
		File file = new File("Input20_1B.txt");
		Scanner inFile = new Scanner(file);
		// Read the array of persons from file
		while (inFile.hasNext()) {
			String name = inFile.nextLine();
			int age = inFile.nextInt();
			persons.add(new Person(name, age));
			
			if (inFile.hasNextLine()) {
				inFile.nextLine();
			}
		}
		
		Person person = findPerson(persons);
		
		if (person != null)
			System.out.println("The last person with age > 30: " + person);
		else 
			System.out.println("There is no person with age > 30");
		
	}
	
	public static Person findPerson(ArrayList<Person> persons) {
		ListIterator<Person> it = persons.listIterator();
		double average, total = 0;
		System.out.println("--- ArrayList of Person ---");
		while (it.hasNext()) {
			Person temp = it.next();
			System.out.println(temp);
			total += temp.getAge();
		}
		average = total / persons.size(); // calculate the average
		
		System.out.println("The average age: " + String.format("%.2f", average));
		
		while (it.hasPrevious()) {
			Person temp = it.previous();
			if (temp.getAge() > 30) {
				return temp;
			}
		}
		return null; // not found
	}

}

// class Person
class Person {
	private String name;
	private int age;
	
	public Person(String _name, int _age) {
		name = _name;
		age = _age;
	}
	
	public int getAge() {
		return age;
	}
	public String getName() {
		return name;
	}
	public String toString() {
		return "Name: " + name + "\tAge: " + age;
	}
}